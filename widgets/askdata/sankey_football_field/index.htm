<html>

    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>


    
    </head>
    
    <body style="background-image: url('field.svg');  background-repeat: no-repeat; background-size: cover;">
        <div id="container" style="margin-top: 3.8%; margin-left: 4%; width: 100%; height: 90%;min-width: 100%;"></div>
     


    <script>
        var dom = document.getElementById("container");
        var myChart = echarts.init(dom);
        
        $(window).on('resize', resize);

        // Resize function
        function resize() {
        setTimeout(function () {
            // Resize chart
            myChart.resize();
        }, 100);
}
        var app = {};
        var option;

        // From

        // var nomi =  ["Donnarumma","Romagnoli","Kjaer","Florenzi","Kolarov","Bennacer","De Rossi","Tonali","Diaz","Ibra","Under"]
        var sources = ["Barella","Barella","Barella","Barella","Barella","Barella","Barella","Barella","Bastoni","Bastoni","Bastoni","Bastoni","Bastoni","Bastoni","Bastoni","Brozovic","Brozovic","Brozovic","Brozovic","Brozovic","Brozovic","Calhanoglu","Calhanoglu","Calhanoglu","Calhanoglu","Calhanoglu","Darmian","Darmian","Darmian","Darmian","Dzeko","Dzeko","Dzeko","Handanovic","Handanovic","Perisic"]
        var targets = ["Bastoni","Brozovic","Calhanoglu","Darmian","Dzeko","Handanovic","Perisic","Skriniar","Brozovic","Calhanoglu","Darmian","Dzeko","Handanovic","Perisic","Skriniar","Calhanoglu","Darmian","Dzeko","Handanovic","Perisic","Skriniar","Darmian","Dzeko","Handanovic","Perisic","Skriniar","Dzeko","Handanovic","Perisic","Skriniar","Handanovic","Perisic","Skriniar","Perisic","Skriniar","Skriniar"]
        var scores = [ 58,128,45,57,49,31,31,87,111,76,10,14,72,64,54,71,67,44,56,39,131,23,17,18,35,35,28,18,13,90,25,17,17,10,94,9]

        // var nomi =  data.fields.m1_id.data
        // var sources= data.fields.m1_id.data
        // var targets = data.fields.m2_id.data
        // var scores = data.fields.m3_id.data

        var nomi = [...sources, ...targets];
        nomi = [...new Set(nomi)];

        var dict_nomi = []
        for (let i = 0; i < nomi.length; i++) {
            var newrow = {name: nomi[i]};   
            dict_nomi.push(newrow);
        }

        var dict_passaggi = []
        for (let i = 0; i < sources.length; i++) {
            var newrow = {source: sources[i], target: targets[i], value: scores[i]};   
            dict_passaggi.push(newrow);
        }


        // data= {"nodes": [
        //       {"name": "Donnarumma"},
        //       {"name": "Romagnoli"},
        //       {"name": "Kjaer"},
        //       {"name": "Florenzi"},
        // 	  {"name": "Kolarov"},
        // 	  {"name": "Bennacer"},
        // 	  {"name": "De Rossi"},
        // 	  {"name": "Tonali"},
        // 	  {"name": "Diaz"},
        // 	  {"name": "Ibra"},
        // 	  {"name": "Under"}

        //    ],
        //    "links": [
        //       {"source": "Donnarumma", "target": "Florenzi", "value": 1.342284047256003},
        //       {"source": "Donnarumma", "target": "Kolarov", "value": 0.42322870366987},
        //       {"source": "Donnarumma", "target": "Kjaer", "value": 0.177682517071359},
        //       {"source": "Donnarumma", "target": "Romagnoli", "value": 0.0433076373512774},
        //       {"source": "Florenzi", "target": "Bennacer", "value": 0.137241325342711},
        //       {"source": "Kolarov", "target": "Bennacer", "value": 0.137241325342711},
        //       {"source": "Romagnoli", "target": "Bennacer", "value": 0.137241325342711},
        //       {"source": "Kjaer", "target": "Bennacer", "value": 0.137241325342711},
        //       {"source": "Florenzi", "target": "Tonali", "value": 0.137241325342711},
        //       {"source": "Kolarov", "target": "Tonali", "value": 0.137241325342711},
        //       {"source": "Romagnoli", "target": "Tonali", "value": 0.137241325342711},
        //       {"source": "Kjaer", "target": "Tonali", "value": 0.137241325342711},
        //       {"source": "Florenzi", "target": "De Rossi", "value": 0.137241325342711},
        //       {"source": "Kolarov", "target": "De Rossi", "value": 0.137241325342711},
        //       {"source": "Romagnoli", "target": "De Rossi", "value": 0.137241325342711},
        //       {"source": "Kjaer", "target": "De Rossi", "value": 0.137241325342711},
        //       {"source": "Bennacer", "target": "Diaz", "value": 0.237241325342711},
        //       {"source": "De Rossi", "target": "Ibra", "value": 0.237241325342711},
        //       {"source": "Tonali", "target": "Under", "value": 0.237241325342711}]}

            option = {
                grid: {
                    responsive: true,
                containLabel: true,    
                left: 20,
                top: 20,
                right: 20,
                bottom: 20
                },
                tooltip: {
                    trigger: 'item',
                    triggerOn: 'mousemove'
                },
                series: [
                    {
                        type: 'sankey',
                        data: dict_nomi,
                        links: dict_passaggi,
                        label: {
                            normal: {
                                show: true,
                                position: 'right',
                                fontSize: 13,
                                fontFamily: 'Roboto'
                            }
                        },
                        emphasis: {
                            focus: 'adjacency'
                        },
                        levels: [{
                            depth: 0,
                            itemStyle: {
                                color: '#C82538'
                            },
                            lineStyle: {
                                color: 'source',
                                opacity: 0.3
                            }
                        }, {
                            depth: 1,
                            itemStyle: {
                                color: '#fbb034'
                            },
                            lineStyle: {
                                color: 'source',
                                opacity: 0.3
                            }
                        }, {
                            depth: 2,
                            itemStyle: {
                                color: '#2E7F18'
                            },
                            lineStyle: {
                                color: 'source',
                                opacity: 0.3
                            }
                        }, {
                            depth: 3,
                            itemStyle: {
                                color: '#ccebc5'
                            },
                            lineStyle: {
                                color: 'source',
                                opacity: 0.8
                            }
                        }],
                        lineStyle: {
                            curveness: 0.5
                        }
                    }
                ]
            };


        if (option && typeof option === 'object') {
            myChart.setOption(option);
        }

    </script>
    
    </body>
    
</html>