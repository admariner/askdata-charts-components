<!DOCTYPE html>
<html style="height: 100%">
<head>
        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        
        <!-- These imports are required -->
        <script src="/lib/scripts/utils.js"></script>
        <script src="/lib/scripts/env.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/js-cookie@rc/dist/js.cookie.min.js"></script>
        <!-- Roboto font -->
        <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" rel="stylesheet">

        <!-- You can leave this library import if you use eCharts library otherwise you can remove it -->
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
        
        <!-- You can leave this library import if you use JQuery. Beware that this example uses JQuery -->
        <script src="/lib/scripts/jquery.min.js"></script>

        <!-- You can leave this library import if you use Mustache library otherwise you can remove it -->
        <script src="https://unpkg.com/mustache@latest"></script>

        <!-- Default styling -->
        <link href="/lib/styles/css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" type="text/css" href="/lib/styles/style.css">
        
        <!-- Other JS libraries or CSS import-->
        <!-- Put your libaries here --->
    </head>

    <body style="width: 100%;height: 100%;">
        
        <div id="container" style="width:100%; height: 100%;display: flex; align-items: center;justify-content: center;">
            
            <svg width="100%" viewBox="0 0 1194 450" fill="none" xmlns="http://www.w3.org/2000/svg">
                <!-- <rect width="100%" height="100%" fill="#E5E5E5"/>
                <rect x="0" y="0" width="100%" height="100%" rx="22.5" fill="white"/> -->
                <g filter="url(#filter0_d)">
                <rect x="54" y="62" width="346" height="153" rx="16" fill="#21367F" id = "primo"/>
                <rect x="54.5" y="62.5" width="345" height="152" rx="15.5" stroke="url(#paint0_linear)"/>
                <text fill="#FCFCFC" id = "primoa" xml:space="preserve" style="white-space: pre" font-family="Roboto" font-size="40" font-weight="bold" letter-spacing="0em"><tspan x="223" y="138.5" text-anchor="middle">{{fields.m1_id.0.data}}</tspan></text>
                <text fill="#FCFCFC" id = "primob" xml:space="preserve" style="white-space: pre" font-family="Roboto" font-size="24" font-weight="bold" letter-spacing="0em"><tspan x="223" y="198.203" text-anchor="middle">{{fields.m1_id.0.name}}</tspan></text>
                </g>
                <g filter="url(#filter1_d)">
                <rect x="54" y="228" width="346" height="153" rx="16" fill="#21367F" id = "secondo"/>
                <rect x="54.5" y="228.5" width="345" height="152" rx="15.5" stroke="url(#paint1_linear)"/>
                <text fill="#FCFCFC" id = "secondoa" xml:space="preserve" style="white-space: pre" font-family="Roboto" font-size="40" font-weight="bold" letter-spacing="0em"><tspan x="223" y="304" text-anchor="middle">{{fields.m1_id.0.data.0}}</tspan></text>
                <text fill="#FCFCFC" id = "secondob" xml:space="preserve" style="white-space: pre" font-family="Roboto" font-size="24" font-weight="bold" letter-spacing="0em"><tspan x="223" y="364" text-anchor="middle">{{fields.m1_id.1.name}}</tspan></text>
                </g>
                <g filter="url(#filter2_d)">
                <rect x="430" y="62" width="346" height="153" rx="16" fill="#21367F" id = "terzo"/>
                <rect x="430.5" y="62.5" width="345" height="152" rx="15.5" stroke="url(#paint2_linear)"/>
                <text fill="#FCFCFC" id = "terzoa" xml:space="preserve" style="white-space: pre" font-family="Roboto" font-size="40" font-weight="bold" letter-spacing="0em"><tspan x="603.5" y="138.5" text-anchor="middle">{{fields.m1_id.0.data[0]}}</tspan></text>
                <text fill="#FCFCFC" id = "terzob" xml:space="preserve" style="white-space: pre" font-family="Roboto" font-size="24" font-weight="bold" letter-spacing="0em"><tspan x="603.5" y="198.203" text-anchor="middle">{{fields.m1_id.2.name}}</tspan></text>
                </g>
                <g filter="url(#filter3_d)">
                <rect x="430" y="228" width="346" height="153" rx="16" fill="#21367F" id = "quarto"/>
                <rect x="430.5" y="228.5" width="345" height="152" rx="15.5" stroke="url(#paint3_linear)"/>
                <text fill="#FCFCFC" id = "quartoa" xml:space="preserve" style="white-space: pre" font-family="Roboto" font-size="40" font-weight="bold" letter-spacing="0em"><tspan x="603.5" y="304" text-anchor="middle">{{fields.m4_id.data.0}}</tspan></text>
                <text fill="#FCFCFC" id = "quartob" xml:space="preserve" style="white-space: pre" font-family="Roboto" font-size="24" font-weight="bold" letter-spacing="0em"><tspan x="603.5" y="364" text-anchor="middle">{{fields.m4_id.name}}</tspan></text>
                
                </g>
                <g filter="url(#filter4_d)">
                <rect x="806" y="62" width="346" height="153" rx="16" fill="#21367F" id = "quinto"/>
                <rect x="806.5" y="62.5" width="345" height="152" rx="15.5" stroke="url(#paint4_linear)"/>
                <text fill="#FCFCFC" id = "quintoa" xml:space="preserve" style="white-space: pre" font-family="Roboto" font-size="40" font-weight="bold" letter-spacing="0em"><tspan x="975" y="138.5" text-anchor="middle">{{fields.m5_id.data.0}}</tspan></text>
                <text fill="#FCFCFC" id = "quintob" xml:space="preserve" style="white-space: pre" font-family="Roboto" font-size="24" font-weight="bold" letter-spacing="0em"><tspan x="975" y="198.203" text-anchor="middle">{{fields.m5_id.name}}</tspan></text>
                </g>
                <g filter="url(#filter5_d)">
                <rect x="806" y="228" width="346" height="153" rx="16" fill="#21367F" id="sesto"/>
                <rect x="806.5" y="228.5" width="345" height="152" rx="15.5" stroke="url(#paint5_linear)"/>
                <text fill="#FCFCFC" id="sestoa" xml:space="preserve" style="white-space: pre" font-family="Roboto" font-size="40" font-weight="bold" letter-spacing="0em"><tspan x="975" y="304" text-anchor="middle">{{fields.m6_id.data.0}}</tspan></text>
                <text fill="#FCFCFC" id="sestob" xml:space="preserve" style="white-space: pre" font-family="Roboto" font-size="24" font-weight="bold" letter-spacing="0em"><tspan x="975" y="364" text-anchor="middle">{{fields.m6_id.name}}</tspan></text>
                
                </g>
                
                <!-- <rect x="7.5" y="7.5" width="1179" height="435" rx="22.5" stroke="white" stroke-width="50"/> -->
                
                <defs>
                <filter id="filter0_d" x="42" y="54" width="370" height="177" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                <feFlood flood-opacity="0" result="BackgroundImageFix"/>
                <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
                <feOffset dy="4"/>
                <feGaussianBlur stdDeviation="6"/>
                <feColorMatrix type="matrix" values="0 0 0 0 0.635069 0 0 0 0 0.776394 0 0 0 0 0.983333 0 0 0 0.3 0"/>
                <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow"/>
                <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow" result="shape"/>
                </filter>
                <filter id="filter1_d" x="42" y="220" width="370" height="177" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                <feFlood flood-opacity="0" result="BackgroundImageFix"/>
                <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
                <feOffset dy="4"/>
                <feGaussianBlur stdDeviation="6"/>
                <feColorMatrix type="matrix" values="0 0 0 0 0.635069 0 0 0 0 0.776394 0 0 0 0 0.983333 0 0 0 0.3 0"/>
                <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow"/>
                <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow" result="shape"/>
                </filter>
                <filter id="filter2_d" x="418" y="54" width="370" height="177" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                <feFlood flood-opacity="0" result="BackgroundImageFix"/>
                <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
                <feOffset dy="4"/>
                <feGaussianBlur stdDeviation="6"/>
                <feColorMatrix type="matrix" values="0 0 0 0 0.635069 0 0 0 0 0.776394 0 0 0 0 0.983333 0 0 0 0.3 0"/>
                <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow"/>
                <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow" result="shape"/>
                </filter>
                <filter id="filter3_d" x="414" y="220" width="370" height="177" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                <feFlood flood-opacity="0" result="BackgroundImageFix"/>
                <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
                <feOffset dy="4"/>
                <feGaussianBlur stdDeviation="6"/>
                <feColorMatrix type="matrix" values="0 0 0 0 0.635069 0 0 0 0 0.776394 0 0 0 0 0.983333 0 0 0 0.3 0"/>
                <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow"/>
                <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow" result="shape"/>
                </filter>
                <filter id="filter4_d" x="794" y="54" width="370" height="177" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                <feFlood flood-opacity="0" result="BackgroundImageFix"/>
                <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
                <feOffset dy="4"/>
                <feGaussianBlur stdDeviation="6"/>
                <feColorMatrix type="matrix" values="0 0 0 0 0.635069 0 0 0 0 0.776394 0 0 0 0 0.983333 0 0 0 0.3 0"/>
                <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow"/>
                <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow" result="shape"/>
                </filter>
                <filter id="filter5_d" x="790" y="220" width="370" height="177" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                <feFlood flood-opacity="0" result="BackgroundImageFix"/>
                <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
                <feOffset dy="4"/>
                <feGaussianBlur stdDeviation="6"/>
                <feColorMatrix type="matrix" values="0 0 0 0 0.635069 0 0 0 0 0.776394 0 0 0 0 0.983333 0 0 0 0.3 0"/>
                <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow"/>
                <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow" result="shape"/>
                </filter>
                <linearGradient id="paint0_linear" x1="227" y1="62" x2="227" y2="215" gradientUnits="userSpaceOnUse">
                <stop stop-color="#E9F2FF" stop-opacity="0"/>
                <stop offset="1" stop-color="#E9F2FF"/>
                </linearGradient>
                <linearGradient id="paint1_linear" x1="223" y1="228" x2="223" y2="381" gradientUnits="userSpaceOnUse">
                <stop stop-color="#E9F2FF" stop-opacity="0"/>
                <stop offset="1" stop-color="#E9F2FF"/>
                </linearGradient>
                <linearGradient id="paint2_linear" x1="603" y1="62" x2="603" y2="215" gradientUnits="userSpaceOnUse">
                <stop stop-color="#E9F2FF" stop-opacity="0"/>
                <stop offset="1" stop-color="#E9F2FF"/>
                </linearGradient>
                <linearGradient id="paint3_linear" x1="599" y1="228" x2="599" y2="381" gradientUnits="userSpaceOnUse">
                <stop stop-color="#E9F2FF" stop-opacity="0"/>
                <stop offset="1" stop-color="#E9F2FF"/>
                </linearGradient>
                <linearGradient id="paint4_linear" x1="979" y1="62" x2="979" y2="215" gradientUnits="userSpaceOnUse">
                <stop stop-color="#E9F2FF" stop-opacity="0"/>
                <stop offset="1" stop-color="#E9F2FF"/>
                </linearGradient>
                <linearGradient id="paint5_linear" x1="975" y1="228" x2="975" y2="381" gradientUnits="userSpaceOnUse">
                <stop stop-color="#E9F2FF" stop-opacity="0"/>
                <stop offset="1" stop-color="#E9F2FF"/>
                </linearGradient>
                </defs>
                </svg>
                
            
        </div>

    </body>



<!-- BEGINNING OF THE DATA LOADER SNIPPET -->
<script type="text/javascript">

// Uncomment to test on localhost after the publish on DEV before the approval in QA and/or PROD
//environment_widget = "https://api-dev.askdata.com";
//environment_widget = "https://api.askdata.com"  // prod  da togliere quando porto su...

console.log("I'm going to request data");

$.ajax({

url: environment_widget +"/smartinsight/widgets/" + getUrlParameter('widgetId'),
type: "GET",
async: false,
beforeSend: function(xhr){xhr.setRequestHeader('Authorization', 'Bearer ' + getToken() 
 ).setRequestHeader('Content-Type','application/json')},
success: function(data) { 

    console.log("Requesting data if the WS answers 200");
    /// PUT YOUR CODE THAT RENDER THE WIDGET RESULTS

    //Log data repsonse
    console.log(data);

    // Select the HTML to render as temple
    var template = document.getElementById('container').innerHTML;
    
    // Rendering of the template
    var rendered = Mustache.render(template, data);
    
    // replace of the SVG
    document.getElementById('container').innerHTML = rendered;

    try
    {
    var col1 = data.fields.s1_id.data
    var col2 = data.fields.s2_id.data
    var col3 = data.fields.s3_id.data
    } 

    catch (error) 
    {
    console.error(error);
    var col1 = "#21367F"
    var col2 = '#FCFCFC'
    var col3 = '#FCFCFC'
    }

    document.getElementById("primo").style.fill = col1;
    document.getElementById("primoa").style.fill = col2;
    document.getElementById("primob").style.fill = col3;
    document.getElementById("secondo").style.fill = col1;
    document.getElementById("secondoa").style.fill = col2;
    document.getElementById("secondob").style.fill = col3;
    document.getElementById("terzo").style.fill = col1;
    document.getElementById("terzoa").style.fill = col2;
    document.getElementById("terzob").style.fill = col3;
    document.getElementById("quarto").style.fill = col1;
    document.getElementById("quartoa").style.fill = col2;
    document.getElementById("quartob").style.fill = col3;
    document.getElementById("quinto").style.fill = col1;
    document.getElementById("quintoa").style.fill = col2;
    document.getElementById("quintob").style.fill = col3;
    document.getElementById("sesto").style.fill = col1;
    document.getElementById("sestoa").style.fill = col2;
    document.getElementById("sestob").style.fill = col3;
    
    }

  });
</script>
<!-- END OF THE DATA LOADER SNIPPET -->

</html>
    
